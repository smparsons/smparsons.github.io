{"componentChunkName":"component---src-templates-blog-post-tsx","path":"/what-are-source-maps/","webpackCompilationHash":"4c761ff306a6264530c4","result":{"data":{"site":{"siteMetadata":{"title":"Sam the Coder","author":"Samuel Parsons"}},"markdownRemark":{"id":"f4e0ce11-58fb-57c9-b985-047139739743","excerpt":"Have you heard other web developers talk about source maps but never truly understood their purpose? Today I wanted to talk about what they are and what we gain…","html":"<p>Have you heard other web developers talk about <em>source maps</em> but never truly understood their purpose? Today I wanted to talk about what they are and what we gain from utilizing source maps in our development workflow.</p>\n<p>When you use a tool to generate an output file from a collection of source files, a <em>source map</em> is a file that maps the generated output file back to the original source files. After this mapping is interpreted by the browser’s developer tools, the developer will be able to debug with the original source files instead of the generated one.</p>\n<p>For example, let’s assume for a moment that we have a minified JavaScript file. A minified JavaScript file is impossible to debug, and stack traces that result from errors occurring in a minified file are too cryptic to read. If you need to debug an error and you’re using a minified file, a source map will help. A source map will allow you to debug using the original JavaScript files. Similarly, you can utilize source maps for transpiled languages such as TypeScript or CoffeeScript. This would give you the ability to debug the TypeScript or CoffeeScript files in developer tools instead of the generated JavaScript file. You can even apply source maps to CSS. Source maps are commonly used with CSS Preprocessors such as SASS or LESS to make debugging styles easier.</p>\n<h2>But How do Source Maps Work?</h2>\n<p>The content of a source map is a JSON object containing mapping metadata that will be processed by the browser once the user opens developer tools.</p>\n<p>Below is an example of a source map file taken straight from the <a href=\"https://sourcemaps.info/spec.html\">version 3 spec</a>:</p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token punctuation\">{</span>\n  <span class=\"token property\">\"version\"</span> <span class=\"token operator\">:</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"file\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"out.js\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"sourceRoot\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"sources\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"foo.js\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"bar.js\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"sourcesContent\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token null keyword\">null</span><span class=\"token punctuation\">,</span> <span class=\"token null keyword\">null</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"names\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"src\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"maps\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"are\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"fun\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"mappings\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"A,AAAB;;ABCDE;\"</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>In this file:</p>\n<ul>\n<li><code class=\"language-text\">version</code> represents the version of the source map standard that is being followed. The latest version is 3, which is the version you will always want to use.</li>\n<li><code class=\"language-text\">file</code> is the name of the output file that was mapped to the original collection of source files.</li>\n<li><code class=\"language-text\">sourceRoot</code> allows you to declare the root path of your source files.</li>\n<li><code class=\"language-text\">sources</code> is the names of the original collection of source files that were used to generate the output file.</li>\n<li><code class=\"language-text\">sourcesContent</code> contains an array of the content of each source file. Each element in the array contains the content of one of the source files, following the same ordering as <code class=\"language-text\">sources</code>. This is generally used when the source files aren’t available. Unless you want to inline the content of the source files in your source map, these elements can be null.</li>\n<li><code class=\"language-text\">names</code> represents all of the variable names that were used in the original collection of files.</li>\n<li><code class=\"language-text\">mappings</code> is a very large string that contains the actual mappings from the output file to the original collection of source files, encoded in Base64 VLQ. Why Base64 VLQ? This method of building the mappings string results in a much smaller source map file size compared to versions 1 and 2.</li>\n</ul>\n<p>In order to use a source map, your generated file needs to list the path to the source map at the bottom. So as an example, if you had a file that was called “out.js”, and you needed to use the source map “out.js.map”, then the following comment would need to be inserted at the bottom of “out.js”:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token comment\">// out.js</span>\n<span class=\"token keyword\">var</span> foo <span class=\"token operator\">=</span> <span class=\"token string\">\"bar\"</span>\n<span class=\"token operator\">...</span>\n<span class=\"token comment\">//# sourceMappingURL=out.js.map</span></code></pre></div>\n<p>Generally, the tool you use to generate your source map will add this comment for you. </p>\n<p>Once this comment is added, then when you run your app and open developer tools, the browser will look for the sourceMappingURL comment at the bottom of your generated file and will attempt to attach the source map based on the source map file name your provided.</p>\n<h2>What about Inline Source Maps?</h2>\n<p>An inline source map is a source map that is embedded at the bottom of the generated file as a base64 encoded string:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token comment\">// out.js</span>\n<span class=\"token keyword\">var</span> foo <span class=\"token operator\">=</span> <span class=\"token string\">\"bar\"</span>\n<span class=\"token operator\">...</span>\n<span class=\"token comment\">//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoib3V0LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiZm9vLmpzIiwiYmFyLmpzIl0sInNvdXJjZXNDb250ZW50IjpbbnVsbCwgbnVsbF0sIm5hbWVzIjpbInNyYyIsIm1hcHMiLCJhcmUiLCJmdW4iXSwibWFwcGluZ3MiOiJBLEFBQUI7O0FCQ0RFOyJ9</span></code></pre></div>\n<p>If you were to decode the above base64 string, you would get the same source map example that I showed above.</p>\n<p>Why use inline source maps? Since there aren’t any separate source map files that need to be loaded, it brings a slight performance increase. It could be beneficial in a development environment depending on your application. However it is not recommended in a production environment because of the increased bundle size.</p>\n<h2>Enabling Source Maps in Module Bundlers</h2>\n<p>With today’s modern development tools, enabling source maps is not a difficult task at all. To prove my point, here are a few short examples from three popular module bundlers:</p>\n<h3>Webpack</h3>\n<p>In Webpack, you can enable source maps by passing the value <code class=\"language-text\">&quot;source-map&quot;</code> to the option <code class=\"language-text\">devtool</code>:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> path <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'path'</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">const</span> HtmlWebpackPlugin <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'html-webpack-plugin'</span><span class=\"token punctuation\">)</span>\n\nmodule<span class=\"token punctuation\">.</span>exports <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  entry<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'./src/index.js'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  output<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n    filename<span class=\"token punctuation\">:</span> <span class=\"token string\">'bundle.js'</span><span class=\"token punctuation\">,</span>\n    path<span class=\"token punctuation\">:</span> path<span class=\"token punctuation\">.</span><span class=\"token function\">resolve</span><span class=\"token punctuation\">(</span>__dirname<span class=\"token punctuation\">,</span> <span class=\"token string\">'build'</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  devtool<span class=\"token punctuation\">:</span> <span class=\"token string\">'source-map'</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Depending on your goals, <code class=\"language-text\">&quot;source-map&quot;</code> may not always be appropriate. If you need inline source maps, you could pass <code class=\"language-text\">&quot;inline-source-map&quot;</code> or <code class=\"language-text\">&quot;inline-cheap-source-map&quot;</code>.  See <a href=\"https://webpack.js.org/configuration/devtool/\">the documentation</a> for a complete reference to the different values that can be passed to <code class=\"language-text\">devtool</code>.</p>\n<h3>Rollup</h3>\n<p>In Rollup, source maps can be enabled by passing <code class=\"language-text\">true</code> to the key <code class=\"language-text\">sourcemap</code> in the config’s <code class=\"language-text\">output</code> object:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\">module<span class=\"token punctuation\">.</span>exports <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  input<span class=\"token punctuation\">:</span> <span class=\"token string\">'./src/index.js'</span><span class=\"token punctuation\">,</span>\n  output<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n    file<span class=\"token punctuation\">:</span> <span class=\"token string\">'bundle.js'</span><span class=\"token punctuation\">,</span>\n    format<span class=\"token punctuation\">:</span> <span class=\"token string\">'cjs'</span><span class=\"token punctuation\">,</span>\n    sourcemap<span class=\"token punctuation\">:</span> <span class=\"token boolean\">true</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>You can also use inline source maps by passing <code class=\"language-text\">&quot;inline&quot;</code> instead of <code class=\"language-text\">true</code>.</p>\n<h3>Browserify</h3>\n<p>Enabling inline source maps is as simple as passing <code class=\"language-text\">--debug</code> in the command line:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">browserify --debug ./src/index.js -o bundle.js</code></pre></div>\n<p>If you want the source maps in separate files, you’ll need to use <a href=\"https://github.com/thlorenz/exorcist\">exorcist</a>.</p>\n<h2>Conclusion</h2>\n<p>Source maps are a great addition to your development workflow, as they make debugging a lot easier when dealing with code that was generated from a collection of source files (such as minified/combined or transpiled code). If you need to include source maps in your workflow, they are easy to integrate with today’s modern development tools.</p>","frontmatter":{"title":"What are Source Maps?","date":"October 25, 2019","description":""}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"/what-are-source-maps/","previous":{"fields":{"slug":"/first-post/"},"frontmatter":{"title":"First Post"}},"next":null}}}